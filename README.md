# Домашняя работа по курсу Методы Обработки Больших данных

# ЗАДАНИЕ 1. Анализ поездок посредством Spark DataFrame API

### Наборы данных:
- Поездки (bikeshare): [данные](https://s3.amazonaws.com/tripdata/201902-citibike-tripdata.csv.zip) | [пояснения](https://www.citibikenyc.com/system-data)
- Кварталы NYC: [данные](https://data.cityofnewyork.us/api/geospatial/d3c5-ddgc?method=export&format=GeoJSON)

### Задача 1

- определите для каждой станции количество начала поездок и количество завершения поездок
- сопоставьте станции с кварталами города (zones) и определите суммы количества начала и завершения для каждого квартала
- выведите по убыванию количества поездок и 
- отобразите в виде картограмм (Choropleth).  

### Задача 3

- оцените дистанцию поездок (в метрах) на основе координат начальной и конечной станций (без учета поездок, завершившихся там же где и начались)
- выведите максимальное, среднее значение, стандартное отклонение и медиан

### Задача 4

- определите для каждой станции среднее количество начала поездок и количество завершения поездок:
    - в день 
    - утром (06:00-11:59), днем (12:00-17:59), вечером (18:00-23:59), ночью (00:00-05:59)
    - в среду и в воскресенье по временным диапазонам (см. выше)
- отобразите полученные данные для второго случая в виде тепловой временной карты (HeatMapWithTime) 

# ЗАДАНИЕ 2. Обработка потоков данных посредством Spark Streaming

⚠️ **Замечание** 
1. В качестве брокера сообщений использовать Kafka
2. Для работы с потоком твитов - пакет tweepy под Python

## Задача 1. Подсчет количества твитов пользователей

Напишите программу, которая подсчитывает количество твитов каждого пользователя в течение 1 мин. и в течение 10 мин. каждые 30 сек (window). Выведите результат в отсортированном по убыванию виде. В списке id пользователей заменить на их screen_name.

Исходные данные:

"285532415", "147964447", "34200559", "338960856", "200036850", "72525490", "20510157", "99918629"

## Задача 2. Подсчет количества ретвитов на твиты пользователей

Напишите программу, которая подсчитывает количество **ретвитов** на твиты каждого пользователя в течение 1 мин. с накоплением. Выведите результат в отсортированном по убыванию виде: id твита, количество ретвитов. Каждую 1 мин. сохранять результат в файл. Накапливать не менее 30 мин. После этого для 5 наиболее популярных твитов вывести: screen_name пользователя, id твита и его текст.

Исходные данные (список id пользователей):

"285532415", "147964447", "34200559", "338960856", "200036850", "72525490", "20510157", "99918629"

## Задача 3. Подсчет количества ответов на твиты пользователей

Напишите программу, которая подсчитывает количество **ответов** на твиты каждого пользователя в течение 1 мин. с накоплением. Выведите результат в отсортированном по убыванию виде: id твита, количество ретвитов. Каждую 1 мин. сохранять результат в файл. Накапливать не менее 30 мин. После этого для 5 наиболее популярных твитов вывести: screen_name пользователя, id твита и его текст.

Исходные данные:

"285532415", "147964447", "34200559", "338960856", "200036850", "72525490", "20510157", "99918629"
